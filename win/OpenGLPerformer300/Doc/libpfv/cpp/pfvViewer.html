<HTML>
<HEAD>
<TITLE>pfvViewer</TITLE>
</HEAD>
<BODY>
<H1>pfvViewer</H1>
<HR>
<PRE>
<!-- Manpage converted by man2html 3.0.1 -->
pfvViewer(3pf)                                     pfvViewer(3pf)




</PRE>
<H2>NAME</H2><PRE>
       <B>pfvViewer</B> - Set up Multi-World, Multi-View, Modular appli-
       cations through XML  file  configuration  or  through  API
       calls.


</PRE>
<H2>FUNCTION SPECIFICATION</H2><PRE>
       #include &lt;Performer/pfv/pfvViewer.h&gt;

                            <B>pfvViewer::pfvViewer</B>();

                            <B>pfvViewer::pfvViewer</B>(char *filename);

                            <B>pfvViewer::pfvViewer</B>(pfvXmlNode *xml);

       int                  <B>pfvViewer::parseXml</B>(pfvXmlNode* xml);

       static pfvViewer*    <B>pfvViewer::getViewer</B>();

       void                 <B>pfvViewer::config</B>();

       void                 <B>pfvViewer::sync</B>();

       void                 <B>pfvViewer::frame</B>();

       void                 <B>pfvViewer::run</B>(float time=-1.0f);

       pfvWorld*            <B>pfvViewer::createWorld</B>();

       pfvWorld*            <B>pfvViewer::createWorld</B>(pfvXmlNode* xml);

       pfvWorld*            <B>pfvViewer::createWorld</B>(char* name);

       int                  <B>pfvViewer::getNumWorlds</B>();

       pfvWorld*            <B>pfvViewer::getWorld</B>(int i=-1);

       pfvWorld*            <B>pfvViewer::findWorld</B>(char*_name);

       int                  <B>pfvViewer::addNode</B>(pfNode*node);

       pfvWorld*            <B>pfvViewer::getCurWorld</B>();

       int                  <B>pfvViewer::getCurWorldIndex</B>();

       void                 <B>pfvViewer::setCurWorld</B>(pfvWorld*w);

       void                 <B>pfvViewer::setCurWorldIndex</B>(int i);

       void                 <B>pfvViewer::autoPos</B>();

       void                 <B>pfvViewer::setTargetWorld</B>(pfvWorld*w);

       void                 <B>pfvViewer::setTargetWorld</B>(int i);

       pfvView*             <B>pfvViewer::getCurView</B>();
       int                  <B>pfvViewer::addModule</B>(pfvModule*m,
                              int scope=PFV_SCOPE_GLOBAL,
                              int scopeIndex=-1);

       int                  <B>pfvViewer::getNumModules</B>();

       pfvModule*           <B>pfvViewer::getModule</B>(int i);

       pfvModule*           <B>pfvViewer::findModule</B>(char*_name);

       pfvModule*           <B>pfvViewer::findModule</B>(char*name,
                              pfType*classType,           pfOb-
                              ject*scopeTarget=NULL);

       pfvModule*           <B>pfvViewer::findModule</B>(char*name,
                              pfObject*scopeTarget,
                              pfType*classType=NULL);

       static const char*   <B>pfvViewer::getCallbackName</B>(int cb);

       static char*         <B>pfvViewer::getCBNames</B>(int cbmask);

       int                  <B>pfvViewer::dispatchCallback</B>(int cb,
                              uint64_t viewMask,        pfvDis-
                              pChan*chan);

       static int           <B>pfvViewer::getStage</B>();


</PRE>
<H2>PARENT CLASS FUNCTIONS</H2><PRE>
       The OpenGL Performer class <B>pfvViewer</B> is derived  from  the
       parent class <B>pfvDisplayMngr</B>, so each of these member func-
       tions of class <B>pfvDisplayMngr</B>  are  also  directly  usable
       with  objects  of  class <B>pfvViewer</B>.  This is also true for
       ancestor classes of class <B>pfvDisplayMngr</B>.

       virtual
                              int            <B>pfvDisplayMngr::loadFile</B>(char* filename);
       virtual
                              int            <B>pfvDisplayMngr::parseXml</B>(pfvXmlNode* xml);
       virtual void           <B>pfvDisplayMngr::preConfig</B>();
       virtual void           <B>pfvDisplayMngr::postConfig</B>();
       virtual
                              pfvDispPipe*   <B>pfvDisplayMngr::createPipe</B>(pfvXmlNode* xml);
       int                    <B>pfvDisplayMngr::getNumPipes</B>();
       pfvDispPipe*           <B>pfvDisplayMngr::getPipe</B>(int i);
       pfvDispPipe*           <B>pfvDisplayMngr::findPipe</B>(char* _name);
       virtual
                              pfvDispView*   <B>pfvDisplayMngr::createView</B>(pfvXmlNode* xml);
       int                    <B>pfvDisplayMngr::getNumViews</B>();
       pfvDispView*           <B>pfvDisplayMngr::getView</B>(int i);
       pfvDispView*           <B>pfvDisplayMngr::findView</B>(char* _name);
       int                    <B>pfvDisplayMngr::getNumPWins</B>();
       pfvDispPWin*           <B>pfvDisplayMngr::getPWin</B>(int i);
       pfvDispPWin*           <B>pfvDisplayMngr::findPWin</B>(char* _name);
       pfvDispPWin*           <B>pfvDisplayMngr::findPWin</B>(pfPipeWindow* pw);
       int                    <B>pfvDisplayMngr::getNumChans</B>();
       pfvDispChan*           <B>pfvDisplayMngr::getChan</B>(int i);
       pfvDispChan*           <B>pfvDisplayMngr::findChan</B>(char* _name);

       void*   <B>pfObject::operator</B> <B>new</B>(size_t, void *arena);
       void*   <B>pfObject::operator</B>     <B>new</B>(size_t,      pfFluxMem-
                 ory *fmem);
       void    <B>pfObject::setUserData</B>(void *data);
       void    <B>pfObject::setUserData</B>(int slot, void *data);
       void*   <B>pfObject::getUserData</B>(pfObject *obj);
       void*   <B>pfObject::getUserData</B>(pfObject *obj, int slot);
       int     <B>pfObject::getNumUserData</B>();


       Since the class <B>pfObject</B> is itself derived from the parent
       class <B>pfMemory</B>, objects of class  <B>pfvViewer</B>  can  also  be
       used  with  these  functions designed for objects of class
       <B>pfMemory</B>.

       void*          <B>pfMemory::getData</B>(const void *ptr);
       pfType *       <B>pfMemory::getType</B>();
       int            <B>pfMemory::isOfType</B>(pfType *type);
       int            <B>pfMemory::isExactType</B>(pfType *type);
       const char *   <B>pfMemory::getTypeName</B>();
       int            <B>pfMemory::copy</B>(pfMemory *src);
       int            <B>pfMemory::compare</B>(const pfMemory *mem);
       void           <B>pfMemory::print</B>(uint which,   uint verbose,
                        char *prefix, FILE *file);
       int            <B>pfMemory::getArena</B>(void *ptr);
       void*          <B>pfMemory::getArena</B>();
       int            <B>pfMemory::ref</B>();
       int            <B>pfMemory::unref</B>();
       int            <B>pfMemory::unrefDelete</B>();
       int            <B>pfMemory::unrefGetRef</B>();
       int            <B>pfMemory::getRef</B>();
       int            <B>pfMemory::checkDelete</B>();
       int            <B>pfMemory::isFluxed</B>();
       void *         <B>pfMemory::getArena</B>();
       int            <B>pfMemory::getSize</B>();


</PRE>
<H2>DESCRIPTION</H2><PRE>
       The  <B>pfvViewer</B>  class  simplifies  setting up multi-scene,
       multi-view, modular applications through XML configuration
       files  and  through  API  calls.  A  <B>pfvViewer</B> extends the
       <B>pfvDisplayMngr</B> class by providing management for  multiple
       scenes  (see  <B>pfvWorld</B>) and by supporting modular extensi-
       bility through <B>pfvModules</B>.

       <B>new</B> <B>pfvViewer</B> creates and returns a handle to a pfvViewer.
       Only  one <B>pfvViewer</B> can be created during the course of an
       application.  Deletion of <B>pfvViewer</B> is not supported.

       <B>new</B> <B>pfvViewer(char</B> <B>*filename)</B> creates and returns a handle
       to  a  <B>pfvViewer</B>.   Before  returning,  the XML file named
       <I>filename</I> is parsed and its contents are used to create and
       configure display objects, worlds and modules.


       <B>new</B>  <B>pfvViewer(pfXmlNode*xml)</B> creates and returns a handle
       to a <B>pfvViewer</B>.  Before returning, the <B>pfvXmlNode</B>  <I>xml</I>  is
       examined and its contents are used to create and configure
       display objects, worlds and modules.

       (.pfv extension) is as follows:


       &lt;?xml version="1.0" ?&gt;

       &lt;viewer&gt;

           &lt;display&gt;
               &lt;pipe&gt;
                   &lt;pwin&gt;
                       &lt;chan&gt; ... &lt;/chan&gt;
                   &lt;/pwin&gt;
               &lt;/pipe&gt;
           &lt;/display&gt;

           &lt;view&gt; ... &lt;/view&gt;
           &lt;world&gt; ...&lt;/world&gt;

           &lt;modulepath&gt;../modules/DSOs&lt;/modulepath&gt;

           &lt;module&gt; ... &lt;/module&gt;
           &lt;module&gt; ... &lt;/module&gt;

       &lt;/viewer&gt;


       At the highest level, <B>pfvViewer</B> accepts the following
       tokens:

              <B>&lt;display&gt;</B> : this tag may contain any number of Dis-
              play Objects
                     declarations, such as pipes, pwins, channels
                     and views. See the man page for
                     <B>pfvDisplayMngr</B> for more details.


              <B>&lt;view&gt;</B> : this tag defines a new view and is equiva-
              lent to a &lt;view&gt;
                     tag contained inside the &lt;display&gt; tag.
                     Note that for <B>pfvViewer</B>-based apps, it is
                     recommended that views be declared outside
                     the <B>&lt;display&gt;</B> tag.  See the man pages for
                     <B>pfvDispView</B> and <B>pfvView</B> for more details.


              <B>&lt;world&gt;</B> : this tag defines a new world (scene). See
              the man
                     page for <B>pfvWorld</B> for more details.


              <B>&lt;modulepath&gt;</B> : this tag can be used to set the
              search path for
                     modules' DSOs. Multiple, colon-separated
                     paths can be provided. See the man page for
                     <B>pfvModule::setLoadPath</B> for more details.


              <B>&lt;module&gt;</B> : this tag instructs the viewer to load a
              new module. See

       does the following:

        o If no worlds have been created, create a default world.
        o If no views have been created, create a default view.
        o Traverse module list and dispatch PRECONFIG callbacks
        o Call <B>pfvDispMngr::preConfig()</B> (see <B>pfvDispMngr</B> man page)
        o Call <B>pfConfig()</B>
        o Call <B>pfvDispMngr::postConfig()</B>
        o Call <B>pfvInputMngr::init()</B> (see <B>pfvInputMngr</B> man page)
        o Create a pfScene for each world
        o Traverse module list and dispatch POSTCONFIG callbacks


       <B>pfvViewer::sync()</B> may be called after a call to
       <B>pfvViewer::frame()</B>, and causes the <B>pfvViewer</B> to call
       <B>pfSync()</B> then traverse module list and dispatch SYNC call-
       backs.

       <B>pfvViewer::frame()</B> will trigger a new simulation frame. If
       <B>pfvViewer::config()</B> has not been called when
       <B>pfvViewer::frame()</B> is called the first time,
       <B>pfvViewer::config()</B> will automatically be called.  If
       <B>pfvViewer::sync()</B> has not been called since the last call
       to <B>pfvViewer::frame()</B>, it will also be automatically
       called here.

       After this, <B>pfvViewer::frame()</B> will call <B>pfFrame()</B>, and do
       the following:

        o Dispatch EXIT_WORLD callbacks to view-scoped modules who are
          exiting a world this frame.
        o Dispatch EXIT_VIEW callbacks to world-scoped modules who are
          being exited by one or more views on this frame.
        o Dispatch ENTER_VIEW callbacks to world-scoped modules who are
          being entered by one or more views on this frame.
        o Dispatch ENTER_WORLD callbacks to view-scoped modules who are
          entering a new world this frame.
        o Update windows position and sizes
        o Collect input events and dispatch input event callbacks
        o Traverse module list and dispatch FRAME callbacks to all
          active modules.



       <B>pfvViewer::run</B> will enter a loop in which
       <B>pfvViewer::frame()</B> is called repeatedly. If a non-negative
       duration is passed as the argument <I>time</I>, <B>pfvViewer</B> will
       exit the loop and terminate the application after the
       specified time has elapsed.

       <B>pfvViewer::createWorld()</B> creates and returns a handle to a
       new <B>pfvWorld</B> object.  All worlds must be created before
       <B>pfvViewer::config</B> is called. The <B>pfvWorld</B> created by this
       function becomes the currently selected world.

       <B>pfvViewer::getNumWorlds()</B> returns the number of worlds
       that have been created.

       <B>pfvViewer::getWorld()</B> returns a handle to the world at
       in viewer's world-list whose name matches <B>_</B><I>name</I>. If no
       world's name matches, this method returns NULL.

       <B>pfvViewer::addNode()</B> will add the specified <B>pfNode</B> to the
       scene associated with the currently selected world. Note
       this method must be called after <B>pfScenes</B> have been cre-
       ated for worlds (no earlier than POSTCONFIG module call-
       backs).

       <B>pfvViewer::getCurWorld()</B> returns a handle to the currently
       selected world, or NULL if there are no worlds yet.

       <B>pfvViewer::getCurWorldIndex()</B> returns the index of the
       currently selected world, or -1 if there are no worlds
       yet.

       <B>pfvViewer::setCurWorld()</B> sets currently selected world.

       <B>pfvViewer::setCurWorldIndex()</B> sets world <I>i</I> to be the cur-
       rently selected world.

       <B>pfvViewer::createView()</B>, <B>pfvViewer::getView()</B>,
       <B>pfvViewer::findView()</B> : see the <B>pfvDisplayMngr</B> man page
       for a description. The newly created <B>pfvView</B> becomes the
       currently selected view.

       <B>pfvViewer::autoPos()</B> calls <B>pfvView::autoPos</B> on currently
       selected view. See the <B>pfvView</B> man page.

       <B>pfvViewer::setTargetWorld()</B> calls <B>pfvView::setTargetWorld</B>
       on currently selected view. See the <B>pfvView</B> man page.

       <B>pfvViewer::getCurView()</B> returns a handle to the currently
       selected view, or NULL if there are no views yet.

       <B>pfvViewer::getCurViewIndex()</B> returns the index of the cur-
       rently selected view, or -1 if there are no views yet.

       <B>pfvViewer::setCurView()</B> sets currently selected view.

       <B>pfvViewer::setCurViewIndex()</B> sets view <I>i</I> to be the cur-
       rently selected view.


       <B>pfvViewer::addModule()</B> will add module <I>m</I> to the viewer's
       module list. Modules can be scoped in one of three ways,
       depending on the value of argument scope:

              <B>PFV_SCOPE_GLOBAL</B> will cause the modue to be glob-
              ally scoped.

              <B>PFV_SCOPE_VIEW</B> will cause module to be scoped to a
              single view.

              <B>PFV_SCOPE_WORLD</B> will cause module to be scoped to a
              single world.

       Differently scoped modules will receive different types of
       callbacks.  See the man pages for <B>pfvModule</B> and for indi-
       in viewer's module-list if <I>i</I> is a valid index, or NULL
       otherwise.

       <B>pfvViewer::findModule()</B> returns a handle to the first mod-
       ule in viewer's module-list whose name matches <B>_</B><I>name</I>. If
       no module's name matches, the method will return NULL.

       <B>pfvViewer::getCallbackName()</B> will return a string contain-
       ing the name of a specific viewer callback (for example,
       <B>pfvViewer::getCallbackName(PFV_CB_POSTCULL)</B> will return
       "PostCull".

       <B>pfvViewer::getCBNames()</B> will create a string containing
       the names of all the callbacks associateds with all set
       bits in the specified mask.

       <B>pfvViewer::dispatchCallback()</B>

       <B>pfvViewer::getStage()</B> returns the current stage of the
       viewer.  The tokens for the different stages are:

              <B>PFV_STAGE_PRECONSTRUCT</B>  a viewer has not yet been
              created

              <B>PFV_STAGE_POSTCONSTRUCT</B>  viewer has been created,
              not configed

              <B>PFV_STAGE_PRECONFIG</B>   viewer is dispatching PRECON-
              FIG callbacks

              <B>PFV_STAGE_POSTCONFIG</B>   viewer is dispatching POST-
              CONFIG callbacks

              <B>PFV_STAGE_CONFIGED</B>   viewer-&gt;config() is done,
              viewer-&gt;frame() not called yet

              <B>PFV_STAGE_RUNTIME</B>   viewer-&gt;frame() already called




</PRE>
<H2>NOTES</H2><PRE>

</PRE>
<H2>SEE ALSO</H2><PRE>
       pfvInputMngr, pfvDisplayMngr, pfvModule, pfvView, pfvWorld



                                                   pfvViewer(3pf)
</PRE>
<HR>
<ADDRESS>
Man(1) output converted with
<a href="http://www.oac.uci.edu/indiv/ehood/man2html.html">man2html</a>
</ADDRESS>
</BODY>
</HTML>
